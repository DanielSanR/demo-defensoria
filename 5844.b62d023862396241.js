(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5844],{7423:(nt,I,P)=>{"use strict";P.d(I,{Uw:()=>j,fo:()=>J});var f=P(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var O=(()=>{return(v=O||(O={})).Unimplemented="UNIMPLEMENTED",v.Unavailable="UNAVAILABLE",O;var v})();class R extends Error{constructor(d,a){super(d),this.message=d,this.code=a}}const K=v=>{var d,a,h,u,m;const b=v.CapacitorCustomPlatform||null,t=v.Capacitor||{},e=t.Plugins=t.Plugins||{},o=v.CapacitorPlatforms,r=(null===(d=o?.currentPlatform)||void 0===d?void 0:d.getPlatform)||(()=>null!==b?b.name:(v=>{var d,a;return v?.androidBridge?"android":null!==(a=null===(d=v?.webkit)||void 0===d?void 0:d.messageHandlers)&&void 0!==a&&a.bridge?"ios":"web"})(v)),l=(null===(a=o?.currentPlatform)||void 0===a?void 0:a.isNativePlatform)||(()=>"web"!==r()),p=(null===(h=o?.currentPlatform)||void 0===h?void 0:h.isPluginAvailable)||(C=>!(!Z.get(C)?.platforms.has(r())&&!_(C))),_=(null===(u=o?.currentPlatform)||void 0===u?void 0:u.getPluginHeader)||(C=>{var G;return null===(G=t.PluginHeaders)||void 0===G?void 0:G.find(Y=>Y.name===C)}),Z=new Map,at=(null===(m=o?.currentPlatform)||void 0===m?void 0:m.registerPlugin)||((C,G={})=>{const Y=Z.get(C);if(Y)return console.warn(`Capacitor plugin "${C}" already registered. Cannot register plugins twice.`),Y.proxy;const N=r(),Q=_(C);let A;const ct=function(){var M=(0,f.Z)(function*(){return!A&&N in G?A=A="function"==typeof G[N]?yield G[N]():G[N]:null!==b&&!A&&"web"in G&&(A=A="function"==typeof G.web?yield G.web():G.web),A});return function(){return M.apply(this,arguments)}}(),it=M=>{let k;const E=(...z)=>{const W=ct().then(F=>{const H=((M,k)=>{var E,z;if(!Q){if(M)return null===(z=M[k])||void 0===z?void 0:z.bind(M);throw new R(`"${C}" plugin is not implemented on ${N}`,O.Unimplemented)}{const W=Q?.methods.find(F=>k===F.name);if(W)return"promise"===W.rtype?F=>t.nativePromise(C,k.toString(),F):(F,H)=>t.nativeCallback(C,k.toString(),F,H);if(M)return null===(E=M[k])||void 0===E?void 0:E.bind(M)}})(F,M);if(H){const tt=H(...z);return k=tt?.remove,tt}throw new R(`"${C}.${M}()" is not implemented on ${N}`,O.Unimplemented)});return"addListener"===M&&(W.remove=(0,f.Z)(function*(){return k()})),W};return E.toString=()=>`${M.toString()}() { [capacitor code] }`,Object.defineProperty(E,"name",{value:M,writable:!1,configurable:!1}),E},rt=it("addListener"),st=it("removeListener"),dt=(M,k)=>{const E=rt({eventName:M},k),z=function(){var F=(0,f.Z)(function*(){const H=yield E;st({eventName:M,callbackId:H},k)});return function(){return F.apply(this,arguments)}}(),W=new Promise(F=>E.then(()=>F({remove:z})));return W.remove=(0,f.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield z()}),W},ot=new Proxy({},{get(M,k){switch(k){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Q?dt:rt;case"removeListener":return st;default:return it(k)}}});return e[C]=ot,Z.set(C,{name:C,proxy:ot,platforms:new Set([...Object.keys(G),...Q?[N]:[]])}),ot});return t.convertFileSrc||(t.convertFileSrc=C=>C),t.getPlatform=r,t.handleError=C=>v.console.error(C),t.isNativePlatform=l,t.isPluginAvailable=p,t.pluginMethodNoop=(C,G,Y)=>Promise.reject(`${Y} does not have an implementation of "${G}".`),t.registerPlugin=at,t.Exception=R,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t.platform=t.getPlatform(),t.isNative=t.isNativePlatform(),t},B=(v=>v.Capacitor=K(v))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),J=B.registerPlugin;class j{constructor(d){this.listeners={},this.windowListeners={},d&&(console.warn(`Capacitor WebPlugin "${d.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=d)}addListener(d,a){var h=this;this.listeners[d]||(this.listeners[d]=[]),this.listeners[d].push(a);const m=this.windowListeners[d];m&&!m.registered&&this.addWindowListener(m);const b=function(){var e=(0,f.Z)(function*(){return h.removeListener(d,a)});return function(){return e.apply(this,arguments)}}(),t=Promise.resolve({remove:b});return Object.defineProperty(t,"remove",{value:(e=(0,f.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield b()}),function(){return e.apply(this,arguments)})}),t;var e}removeAllListeners(){var d=this;return(0,f.Z)(function*(){d.listeners={};for(const a in d.windowListeners)d.removeWindowListener(d.windowListeners[a]);d.windowListeners={}})()}notifyListeners(d,a){const h=this.listeners[d];h&&h.forEach(u=>u(a))}hasListeners(d){return!!this.listeners[d].length}registerWindowListener(d,a){this.windowListeners[a]={registered:!1,windowEventName:d,pluginEventName:a,handler:h=>{this.notifyListeners(a,h)}}}unimplemented(d="not implemented"){return new B.Exception(d,O.Unimplemented)}unavailable(d="not available"){return new B.Exception(d,O.Unavailable)}removeListener(d,a){var h=this;return(0,f.Z)(function*(){const u=h.listeners[d];if(!u)return;const m=u.indexOf(a);h.listeners[d].splice(m,1),h.listeners[d].length||h.removeWindowListener(h.windowListeners[d])})()}addWindowListener(d){window.addEventListener(d.windowEventName,d.handler),d.registered=!0}removeWindowListener(d){!d||(window.removeEventListener(d.windowEventName,d.handler),d.registered=!1)}}},5844:(nt,I,P)=>{"use strict";P.r(I),P.d(I,{OnboardingPageModule:()=>d});var f=P(6895),s=P(4719),w=P(9250),D=P(8359),L=P(5861),T=P(2993);const O=(0,P(7423).fo)("Geolocation",{web:()=>P.e(9695).then(P.bind(P,9695)).then(a=>new a.GeolocationWeb)});var R=P(2709),i=P(6738),K=P(1188),U=P(2670);const B=["swiper"];function J(a,h){if(1&a){const u=i.EpF();i.TgZ(0,"ion-grid",4)(1,"ion-row")(2,"ion-col",5),i._UZ(3,"ion-icon",6),i.qZA(),i.TgZ(4,"ion-col",7)(5,"ion-text",8)(6,"h1",9),i._uU(7,"!Hola!"),i.qZA(),i.TgZ(8,"p",10),i._uU(9," Esta es una aplicaci\xf3n que te permitir\xe1 realizar un pedido de ayuda en el caso que est\xe9s pasando por alguna situaci\xf3n de violencia. Ten\xe9 en cuenta que toda la informaci\xf3n que brindes es confidencial y ser\xe1 utilizada solamente por las personas que proceder\xe1n a ayudarte (ley 25326). A continuaci\xf3n, tendr\xe1s que responder unas breves preguntas para que podamos ayudarte. "),i.qZA()()()(),i.TgZ(10,"ion-row",11)(11,"ion-col",12),i._UZ(12,"ion-icon",13),i.qZA(),i.TgZ(13,"ion-col",14)(14,"ion-text",15)(15,"p"),i._uU(16," Apretando el boton \u201cContinuar\u201d, aceptas nuestros "),i.TgZ(17,"span",16),i._uU(18,"\u201cTerminos y Condiciones & Politicas de Privacidad\u201d."),i.qZA()()()()(),i.TgZ(19,"ion-row",17)(20,"ion-col",18)(21,"ion-button",19),i.NdJ("click",function(){i.CHM(u);const b=i.oxw();return i.KtG(b.next())}),i._uU(22,"Continuar"),i.qZA()()()()}}function $(a,h){if(1&a){const u=i.EpF();i.TgZ(0,"ion-grid",4)(1,"ion-row")(2,"ion-col",5),i._UZ(3,"ion-icon",6),i.qZA()(),i.TgZ(4,"ion-row")(5,"ion-col",7)(6,"ion-text",8)(7,"h1",9),i._uU(8,"Habilita tu ubicaci\xf3n."),i.qZA(),i.TgZ(9,"p",10),i._uU(10," Este sitio web necesita tu ubicaci\xf3n. "),i.qZA()()()(),i.TgZ(11,"ion-row",11)(12,"ion-col",12),i._UZ(13,"ion-icon",20),i.qZA(),i.TgZ(14,"ion-col",14)(15,"ion-text",15)(16,"p"),i._uU(17," Este sitio web utiliza tu ubicaci\xf3n para poder brindarte una mejor experiencia y poder proceder correctamente con tu solicitud. "),i.qZA()()()(),i.TgZ(18,"ion-row",17)(19,"ion-col",18)(20,"ion-button",19),i.NdJ("click",function(){i.CHM(u);const b=i.oxw();return i.KtG(b.getLocation())}),i._uU(21,"Habilitar ubicaci\xf3n"),i.qZA()(),i.TgZ(22,"ion-col",18)(23,"ion-button",21),i.NdJ("click",function(){i.CHM(u);const b=i.oxw();return i.KtG(b.skip())}),i._uU(24," No, m\xe1s tarde. "),i.qZA()()()()}}function V(a,h){if(1&a){const u=i.EpF();i.TgZ(0,"ion-grid",22)(1,"ion-row",23)(2,"ion-col",24),i._UZ(3,"ion-icon",25),i.qZA(),i.TgZ(4,"ion-col",26)(5,"ion-button",27),i.NdJ("click",function(){i.CHM(u);const b=i.oxw();return i.KtG(b.select("kid"))}),i._uU(6," SOY NI\xd1O / NI\xd1A"),i.qZA()()(),i.TgZ(7,"ion-row",28)(8,"ion-col",24),i._UZ(9,"ion-icon",29),i.qZA(),i.TgZ(10,"ion-col",26)(11,"ion-button",27),i.NdJ("click",function(){i.CHM(u);const b=i.oxw();return i.KtG(b.select("teen"))}),i._uU(12," SOY ADOLESCENTE"),i.qZA()()(),i.TgZ(13,"ion-row")(14,"ion-col",24)(15,"ion-button",30),i.NdJ("click",function(){i.CHM(u);const b=i.oxw();return i.KtG(b.save())}),i._UZ(16,"ion-icon",31),i.qZA()()()()}if(2&a){const u=i.oxw();i.xp6(15),i.Q6J("disabled",!u.selected)}}T.ZP.use([T.tl,T.W_,T.pt,T.xW]);const X=[{path:"",component:(()=>{class a{constructor(u,m,b,t){this.router=u,this.cd=m,this.alertController=b,this.storageService=t,this.key="AAPK895f48d83b5543ab80c5d058d510d5971uhYgfFtvdNCIB-no6TgvFEbUE-H-h6ZfPfs9GOWCpAtsp9cTGA8zFsd2DiPWwPf",this.config={allowTouchMove:!1,keyboard:!0,pagination:{type:"progressbar"},effect:"fade",fadeEffect:{crossFade:!0},autoplay:{delay:1e5}}}ngOnInit(){this.background="#F4F4F4"}next(){this.swiper.swiperRef.slideNext(500)}getLocation(){var u=this;return(0,L.Z)(function*(){const m=yield u.alertController.create({header:"Permisos necesarios",message:"Para poder brindarte una mejor experiencia, necesitamos que nos permitas acceder a tu ubicaci\xf3n",buttons:["OK"]});yield O.getCurrentPosition({enableHighAccuracy:!0}).then(t=>{console.log(t),u.latitude=t.coords.latitude,u.longitude=t.coords.longitude,u.swiper.swiperRef.slideNext(500)}).catch(t=>{(0,L.Z)(function*(){yield m.present()})()}),yield u.storageService.setStorage("latlng",[u.latitude,u.longitude]),new R.reverseGeocode({apikey:u.key}).latlng([u.latitude,u.longitude]).run((t,e,o)=>{})})()}save(){var u=this;return(0,L.Z)(function*(){null!==u.selected&&(yield u.storageService.setStorage("selected",u.selected),yield u.storageService.setOnboarding(),u.router.navigate(["/principal/inicio"]))})()}select(u){console.log(u),this.selected=u}skip(){this.swiper.swiperRef.slideNext(500)}ngOnDestroy(){this.swiper.swiperRef.destroy()}onAfterTransition(){2===this.swiper.swiperRef.activeIndex&&(this.background='url("../../assets/images/kid-teen.svg") no-repeat center center / cover')}}return a.\u0275fac=function(u){return new(u||a)(i.Y36(D.F0),i.Y36(i.sBO),i.Y36(w.Br),i.Y36(K.V))},a.\u0275cmp=i.Xpm({type:a,selectors:[["app-onboarding"]],viewQuery:function(u,m){if(1&u&&i.Gf(B,5),2&u){let b;i.iGM(b=i.CRH())&&(m.swiper=b.first)}},decls:6,vars:3,consts:[[1,"ion-padding"],[3,"config","slideChangeTransitionEnd"],["swiper",""],["swiperSlide",""],[1,"Grid-first"],["size","12"],["src","../../assets/icon/navigate.svg",1,"Grid-first-icon"],["size","12",1,"Grid-first-col-text"],[1,"Grid-first-col-text-title"],[1,"Grid-first-col-text-title-h1"],[1,"Grid-first-col-text-title-p"],[1,"Grid-first-row"],["size","12",1,"Grid-first-row-col"],["src","../../assets/icon/family-onboarding.svg",1,"Grid-first-row-col-icon-onboarding"],["size","12",1,"Grid-first-col-tyc"],[1,"Grid-first-col-tyc-text"],[1,"Grid-first-col-tyc-text-note"],[1,"Grid-first-button-row"],["size","12",1,"Grid-first-button-row-col"],[1,"Grid-first-button-row-col-nextBtn",3,"click"],["src","../../assets/icon/location-onboarding.svg",1,"Grid-first-row-col-icon-location-onboarding"],["fill","clear",1,"Grid-first-button-row-col-skipBtn",3,"click"],["fullscreen","true",1,"Grid-choice"],[1,"Grid-choice-row",2,"flex-grow","1"],["size","12",1,"ion-text-center"],["src","../../assets/icon/kid.svg",2,"height","150px","width","230px"],["size","12",1,"Grid-choice-row-col"],[1,"Grid-choice-row-col-Btn",3,"click"],[1,"Grid-choice-row"],["src","../../assets/icon/teen.svg",2,"height","150px","width","230px"],[1,"Arrow-Btn",3,"disabled","click"],["src","../../assets/icon/chevron-forward.svg",1,"Arrow-Btn-Icon"]],template:function(u,m){1&u&&(i.TgZ(0,"ion-content",0)(1,"swiper",1,2),i.NdJ("slideChangeTransitionEnd",function(){return m.onAfterTransition()}),i.YNc(3,J,23,0,"ng-template",3),i.YNc(4,$,25,0,"ng-template",3),i.YNc(5,V,17,1,"ng-template",3),i.qZA()()),2&u&&(i.Udp("--background",m.background),i.xp6(1),i.Q6J("config",m.config))},dependencies:[w.YG,w.wI,w.W2,w.jY,w.gu,w.Nd,w.yW,U.nF,U.YC],styles:["[_nghost-%COMP%]{--background: #F4F4F4;font-family:Open Sans;font-style:normal}.swiper[_ngcontent-%COMP%]{width:100%;height:100%}ion-content[_ngcontent-%COMP%]{background:#F4F4F4;--background:url(kid-teen.73a8215a2407eabd.svg) no-repeat center center / cover}.Grid-first[_ngcontent-%COMP%]{height:100%;display:flex;flex-flow:column}.Grid-first-icon[_ngcontent-%COMP%]{height:32px;width:32px}.Grid-first-col-text[_ngcontent-%COMP%]{padding-top:.5rem}.Grid-first-col-text-title-h1[_ngcontent-%COMP%]{margin-top:0rem!important;font-size:1.2rem!important;font-weight:700}.Grid-first-col-text-title-p[_ngcontent-%COMP%]{text-align:justify;margin-top:.5rem!important;font-weight:400;font-size:.9rem!important;line-height:120%}.Grid-first-row[_ngcontent-%COMP%]{flex-grow:1}.Grid-first-row-col[_ngcontent-%COMP%]{padding-top:1rem}.Grid-first-row-col-icon-onboarding[_ngcontent-%COMP%]{height:200px;width:300px}.Grid-first-row-col-icon-location-onboarding[_ngcontent-%COMP%]{height:300px;width:300px}.Grid-first-col-tyc-text[_ngcontent-%COMP%]{color:#7b7676;font-weight:400;font-size:.8rem;line-height:140%}.Grid-first-col-tyc-text-note[_ngcontent-%COMP%]{font-size:.6rem}.Grid-first-button-row[_ngcontent-%COMP%]{text-align:center}.Grid-first-button-row-col-nextBtn[_ngcontent-%COMP%]{font-weight:100;text-transform:none;--background:#319BFC !important;--color:#fff;width:100%;height:100%;--padding-bottom: .5rem;--border-radius: .2rem;--padding-top: .5rem;font-size:1rem}.Grid-first-button-row-col-skipBtn[_ngcontent-%COMP%]{font-weight:500;text-transform:none;--color:#319BFC;font-size:.9rem}.Grid-choice[_ngcontent-%COMP%]{height:100%;display:flex;flex-flow:column}.Grid-choice-row[_ngcontent-%COMP%]{text-align:center;padding-top:50px!important;height:100%}.Grid-choice-row-col-Btn[_ngcontent-%COMP%]{width:75%;height:auto;--padding-top:11px;--padding-bottom:11px;--background: #FFFFFF;--color:#000;--background-activated:#ffff;font-weight:400;font-size:18px;--border-radius: 15px}.Grid-choice-row-col-Btn[_ngcontent-%COMP%]::part(native){box-shadow:0 4px 4px #00000040}.Grid-choice-row-col-Btn[_ngcontent-%COMP%]::part(activate){--background: #FFFFFF}.Grid-choice-row-col-Btn[_ngcontent-%COMP%]:active, .Grid-choice-row-col-Btn[_ngcontent-%COMP%]:focus{border-radius:15px}.Grid-choice-row-col-Btn[_ngcontent-%COMP%]:active::part(native), .Grid-choice-row-col-Btn[_ngcontent-%COMP%]:focus::part(native){border-color:#ff6600d4;--border-style: solid;--border-width: 3px}.Grid-choice[_ngcontent-%COMP%]   .Arrow-Btn[_ngcontent-%COMP%]{height:49px!important;width:49px!important;--background: linear-gradient(180deg, #FF6600 0%, rgba(251, 21, 34, .33) 100%);--border-radius: 50%}.Grid-choice[_ngcontent-%COMP%]   .Arrow-Btn-Icon[_ngcontent-%COMP%]{height:35px;width:35px;position:absolute}@media (max-width: 376px){.Grid-choice[_ngcontent-%COMP%]   .Grid-choice-row-col-Btn[_ngcontent-%COMP%]{font-size:16px}}"]}),a})()}];let v=(()=>{class a{}return a.\u0275fac=function(u){return new(u||a)},a.\u0275mod=i.oAB({type:a}),a.\u0275inj=i.cJS({imports:[D.Bz.forChild(X),D.Bz]}),a})(),d=(()=>{class a{}return a.\u0275fac=function(u){return new(u||a)},a.\u0275mod=i.oAB({type:a}),a.\u0275inj=i.cJS({imports:[f.ez,s.u5,w.Pc,v,U.kz]}),a})()},2709:function(nt,I,P){!function(f,s,w){"use strict";var L="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer/",T=w.Task.extend({path:"findAddressCandidates",params:{outSr:4326,forStorage:!1,outFields:"*",maxLocations:20},setters:{address:"address",neighborhood:"neighborhood",city:"city",subregion:"subregion",region:"region",postal:"postal",country:"country",text:"singleLine",category:"category",token:"token",apikey:"apikey",key:"magicKey",fields:"outFields",forStorage:"forStorage",maxLocations:"maxLocations",countries:"sourceCountry"},initialize:function(t){(t=t||{}).url=t.url||L,w.Task.prototype.initialize.call(this,t)},within:function(t){return t=s.latLngBounds(t),this.params.searchExtent=w.Util.boundsToExtent(t),this},nearby:function(t,e){var o=s.latLng(t);return this.params.location=o.lng+","+o.lat,e&&(this.params.distance=Math.min(Math.max(e,2e3),5e4)),this},run:function(t,e){return this.options.token&&(this.params.token=this.options.token),this.options.apikey&&(this.params.token=this.options.apikey),this.options.customParam&&(this.params[this.options.customParam]=this.params.singleLine,delete this.params.singleLine),this.request(function(o,n){var c=o?void 0:(0,this._processGeocoderResponse)(n);t.call(e,o,{results:c},n)},this)},_processGeocoderResponse:function(t){for(var e=[],o=0;o<t.candidates.length;o++){var n=t.candidates[o];if(n.extent)var r=w.Util.extentToBounds(n.extent);e.push({text:n.address,bounds:r,score:n.score,latlng:s.latLng(n.location.y,n.location.x),properties:n.attributes})}return e}});function q(t){return new T(t)}var O=w.Task.extend({path:"reverseGeocode",params:{outSR:4326,returnIntersection:!1},setters:{distance:"distance",language:"langCode",intersection:"returnIntersection",apikey:"apikey"},initialize:function(t){(t=t||{}).url=t.url||L,w.Task.prototype.initialize.call(this,t)},latlng:function(t){var e=s.latLng(t);return this.params.location=e.lng+","+e.lat,this},run:function(t,e){return this.options.token&&(this.params.token=this.options.token),this.options.apikey&&(this.params.token=this.options.apikey),this.request(function(o,n){var r;r=o?void 0:{latlng:s.latLng(n.location.y,n.location.x),address:n.address},t.call(e,o,r,n)},this)}});function R(t){return new O(t)}var i=w.Task.extend({path:"suggest",params:{},setters:{text:"text",category:"category",countries:"countryCode",maxSuggestions:"maxSuggestions"},initialize:function(t){(t=t||{}).url||(t.url=L,t.supportsSuggest=!0),w.Task.prototype.initialize.call(this,t)},within:function(t){var e=(t=s.latLngBounds(t)).getCenter(),o=t.getNorthWest();return this.params.location=e.lng+","+e.lat,this.params.distance=Math.min(Math.max(e.distanceTo(o),2e3),5e4),this.params.searchExtent=w.Util.boundsToExtent(t),this},nearby:function(t,e){var o=s.latLng(t);return this.params.location=o.lng+","+o.lat,e&&(this.params.distance=Math.min(Math.max(e,2e3),5e4)),this},run:function(t,e){if(this.options.supportsSuggest)return this.request(function(o,n){t.call(e,o,n,n)},this);console.warn("this geocoding service does not support asking for suggestions")}});function K(t){return new i(t)}var U=w.Service.extend({initialize:function(t){(t=t||{}).apikey&&(t.token=t.apikey),t.url?(w.Service.prototype.initialize.call(this,t),this._confirmSuggestSupport()):(t.url=L,t.supportsSuggest=!0,w.Service.prototype.initialize.call(this,t))},geocode:function(){return q(this)},reverse:function(){return R(this)},suggest:function(){return K(this)},_confirmSuggestSupport:function(){this.metadata(function(t,e){t||(this.options.supportsSuggest=!!e.capabilities&&e.capabilities.indexOf("Suggest")>-1,this.options.customParam=e.singleLineAddressField.name)},this)}});var J=s.Evented.extend({options:{zoomToResult:!0,useMapBounds:12,searchBounds:null},initialize:function(t,e){if(s.Util.setOptions(this,e),this._control=t,!e||!e.providers||!e.providers.length)throw new Error("You must specify at least one provider");this._providers=e.providers},_geocode:function(t,e,o){var c,n=0,r=[],l=s.Util.bind(function(p,y){n--,!p&&(y&&(r=r.concat(y)),n<=0&&(c=this._boundsFromResults(r),this.fire("results",{results:r,bounds:c,latlng:c?c.getCenter():void 0,text:t},!0),this.options.zoomToResult&&c&&this._control._map.fitBounds(c),this.fire("load")))},this);if(e)n++,o.results(t,e,this._searchBounds(),l);else for(var g=0;g<this._providers.length;g++)n++,this._providers[g].results(t,e,this._searchBounds(),l)},_suggest:function(t){var e=this._providers.length,o=0,n=s.Util.bind(function(g,p){return s.Util.bind(function(y,_){if(e-=1,o+=_.length,y)return this._control._clearProviderSuggestions(p),void this._control._finalizeSuggestions(e,o);if(_.length)for(var S=0;S<_.length;S++)_[S].provider=p;else this._control._renderSuggestions(_);p._lastRender!==g&&this._control._clearProviderSuggestions(p),_.length&&this._control._input.value===g&&(p._lastRender=g,this._control._renderSuggestions(_)),this._control._finalizeSuggestions(e,o)},this)},this);this._pendingSuggestions=[];for(var r=0;r<this._providers.length;r++){var c=this._providers[r],l=c.suggestions(t,this._searchBounds(),n(t,c));this._pendingSuggestions.push(l)}},_searchBounds:function(){return null!==this.options.searchBounds?this.options.searchBounds:!1===this.options.useMapBounds?null:!0===this.options.useMapBounds||this.options.useMapBounds<=this._control._map.getZoom()?this._control._map.getBounds():null},_boundsFromResults:function(t){if(t.length){for(var e=s.latLngBounds([0,0],[0,0]),o=[],n=[],r=t.length-1;r>=0;r--){var c=t[r];n.push(c.latlng),c.bounds&&c.bounds.isValid()&&!c.bounds.equals(e)&&o.push(c.bounds)}for(var l=s.latLngBounds(n),g=0;g<o.length;g++)l.extend(o[g]);return l}},_getAttribution:function(){for(var t=[],e=this._providers,o=0;o<e.length;o++)e[o].options.attribution&&t.push(e[o].options.attribution);return t.join(", ")}});function $(t,e){return new J(t,e)}var V=U.extend({options:{label:"Places and Addresses",maxResults:5},suggestions:function(t,e,o){var n=this.suggest().text(t);return e&&n.within(e),this.options.nearby&&n.nearby(this.options.nearby),this.options.countries&&n.countries(this.options.countries),this.options.categories&&n.category(this.options.categories),n.maxSuggestions(this.options.maxResults),n.run(function(r,c,l){var g=[];if(!r)for(;l.suggestions.length&&g.length<=this.options.maxResults-1;){var p=l.suggestions.shift();p.isCollection||g.push({text:p.text,unformattedText:p.text,magicKey:p.magicKey})}o(r,g)},this)},results:function(t,e,o,n){var r=this.geocode().text(t);return e&&r.key(e),r.maxLocations(this.options.maxResults),o&&r.within(o),this.options.forStorage&&r.forStorage(!0),this.options.nearby&&r.nearby(this.options.nearby),this.options.countries&&r.countries(this.options.countries),this.options.categories&&r.category(this.options.categories),r.run(function(c,l){n(c,l.results)},this)}});function j(t){return new V(t)}var X=s.Control.extend({includes:s.Evented.prototype,options:{position:"topleft",collapseAfterResult:!0,expanded:!1,allowMultipleResults:!0,placeholder:"Search for places or addresses",title:"Location Search"},initialize:function(t){s.Util.setOptions(this,t),(!t||!t.providers||!t.providers.length)&&(t||(t={}),t.providers=[j()]),this._geosearchCore=$(this,t),this._geosearchCore._providers=t.providers,this._geosearchCore.addEventParent(this);for(var e=0;e<this._geosearchCore._providers.length;e++)this._geosearchCore._providers[e].addEventParent(this);this._geosearchCore._pendingSuggestions=[],s.Control.prototype.initialize.call(this,t)},_renderSuggestions:function(t){var e;t.length>0&&(this._suggestions.style.display="block");for(var o,n,r=[],c=0;c<t.length;c++){var l=t[c];if(!n&&this._geosearchCore._providers.length>1&&e!==l.provider.options.label&&((n=s.DomUtil.create("div","geocoder-control-header",l.provider._contentsElement)).textContent=l.provider.options.label,n.innerText=l.provider.options.label,e=l.provider.options.label),o||(o=s.DomUtil.create("ul","geocoder-control-list",l.provider._contentsElement)),-1===r.indexOf(l.text)){var g=s.DomUtil.create("li","geocoder-control-suggestion",o);g.innerHTML=l.text,g.provider=l.provider,g["data-magic-key"]=l.magicKey,g.unformattedText=l.unformattedText}else for(var p=0;p<o.childNodes.length;p++)o.childNodes[p].innerHTML===l.text&&(o.childNodes[p]["data-magic-key"]+=","+l.magicKey);r.push(l.text)}this.getPosition().indexOf("top")>-1&&(this._suggestions.style.maxHeight=this._map.getSize().y-this._suggestions.offsetTop-this._wrapper.offsetTop-10+"px"),this.getPosition().indexOf("bottom")>-1&&this._setSuggestionsBottomPosition()},_setSuggestionsBottomPosition:function(){this._suggestions.style.maxHeight=this._map.getSize().y-this._map._controlCorners[this.getPosition()].offsetHeight-this._wrapper.offsetHeight+"px",this._suggestions.style.top=-this._suggestions.offsetHeight-this._wrapper.offsetHeight+20+"px"},_boundsFromResults:function(t){if(t.length){for(var e=s.latLngBounds([0,0],[0,0]),o=[],n=[],r=t.length-1;r>=0;r--){var c=t[r];n.push(c.latlng),c.bounds&&c.bounds.isValid()&&!c.bounds.equals(e)&&o.push(c.bounds)}for(var l=s.latLngBounds(n),g=0;g<o.length;g++)l.extend(o[g]);return l}},clear:function(){this._clearAllSuggestions(),this.options.collapseAfterResult&&(this._input.value="",this._lastValue="",this._input.placeholder="",s.DomUtil.removeClass(this._wrapper,"geocoder-control-expanded")),!this._map.scrollWheelZoom.enabled()&&this._map.options.scrollWheelZoom&&this._map.scrollWheelZoom.enable()},_clearAllSuggestions:function(){this._suggestions.style.display="none";for(var t=0;t<this.options.providers.length;t++)this._clearProviderSuggestions(this.options.providers[t])},_clearProviderSuggestions:function(t){t._contentsElement.innerHTML=""},_finalizeSuggestions:function(t,e){t||(s.DomUtil.removeClass(this._input,"geocoder-control-loading"),this.getPosition().indexOf("bottom")>-1&&this._setSuggestionsBottomPosition(),e||this._clearAllSuggestions())},_setupClick:function(){s.DomUtil.addClass(this._wrapper,"geocoder-control-expanded"),this._input.focus()},disable:function(){this._input.disabled=!0,s.DomUtil.addClass(this._input,"geocoder-control-input-disabled"),s.DomEvent.removeListener(this._wrapper,"click",this._setupClick,this)},enable:function(){this._input.disabled=!1,s.DomUtil.removeClass(this._input,"geocoder-control-input-disabled"),s.DomEvent.addListener(this._wrapper,"click",this._setupClick,this)},getAttribution:function(){for(var t=[],e=0;e<this._providers.length;e++)this._providers[e].options.attribution&&t.push(this._providers[e].options.attribution);return t.join(", ")},geocodeSuggestion:function(t){var e=t.target||t.srcElement;e.classList.contains("geocoder-control-suggestions")||e.classList.contains("geocoder-control-header")||(e.classList.length<1&&(e=e.parentNode),this._geosearchCore._geocode(e.unformattedText,e["data-magic-key"],e.provider),this.clear())},onAdd:function(t){w.Util.setEsriAttribution(t),this._map=t,this._wrapper=s.DomUtil.create("div","geocoder-control"),this._input=s.DomUtil.create("input","geocoder-control-input leaflet-bar",this._wrapper),this._input.title=this.options.title,this.options.expanded&&(s.DomUtil.addClass(this._wrapper,"geocoder-control-expanded"),this._input.placeholder=this.options.placeholder),this._suggestions=s.DomUtil.create("div","geocoder-control-suggestions leaflet-bar",this._wrapper);for(var e=0;e<this.options.providers.length;e++)this.options.providers[e]._contentsElement=s.DomUtil.create("div",null,this._suggestions);var o=this._geosearchCore._getAttribution();return t.attributionControl&&t.attributionControl.addAttribution(o),s.DomEvent.addListener(this._input,"focus",function(n){this._input.placeholder=this.options.placeholder,s.DomUtil.addClass(this._wrapper,"geocoder-control-expanded")},this),s.DomEvent.addListener(this._wrapper,"click",this._setupClick,this),s.DomEvent.addListener(this._suggestions,"mousedown",this.geocodeSuggestion,this),s.DomEvent.addListener(this._input,"blur",function(n){this.clear()},this),s.DomEvent.addListener(this._input,"keydown",function(n){var r=(n.target||n.srcElement).value;s.DomUtil.addClass(this._wrapper,"geocoder-control-expanded");for(var g,c=this._suggestions.querySelectorAll(".geocoder-control-suggestion"),l=this._suggestions.querySelectorAll(".geocoder-control-selected")[0],p=0;p<c.length;p++)if(c[p]===l){g=p;break}switch(n.keyCode){case 13:l?(this._input.value=l.innerText,this._geosearchCore._geocode(l.unformattedText,l["data-magic-key"],l.provider),this.clear()):this.options.allowMultipleResults&&r.length>=2?(this._geosearchCore._geocode(this._input.value,void 0),this.clear()):1===c.length?(s.DomUtil.addClass(c[0],"geocoder-control-selected"),this._geosearchCore._geocode(c[0].innerHTML,c[0]["data-magic-key"],c[0].provider)):(this.clear(),this._input.blur()),s.DomEvent.preventDefault(n);break;case 38:l&&s.DomUtil.removeClass(l,"geocoder-control-selected");var y=c[g-1];s.DomUtil.addClass(l&&y?y:c[c.length-1],"geocoder-control-selected"),s.DomEvent.preventDefault(n);break;case 40:l&&s.DomUtil.removeClass(l,"geocoder-control-selected");var _=c[g+1];s.DomUtil.addClass(l&&_?_:c[0],"geocoder-control-selected"),s.DomEvent.preventDefault(n);break;default:for(var S=0;S<this._geosearchCore._pendingSuggestions.length;S++){var x=this._geosearchCore._pendingSuggestions[S];x&&x.abort&&!x.id&&x.abort()}}},this),s.DomEvent.addListener(this._input,"keyup",s.Util.throttle(function(n){var r=n.which||n.keyCode,c=(n.target||n.srcElement).value;if(c.length<2)return this._lastValue=this._input.value,this._clearAllSuggestions(),void s.DomUtil.removeClass(this._input,"geocoder-control-loading");27!==r?13!==r&&38!==r&&40!==r&&this._input.value!==this._lastValue&&(this._lastValue=this._input.value,s.DomUtil.addClass(this._input,"geocoder-control-loading"),this._geosearchCore._suggest(c)):this._clearAllSuggestions()},50,this),this),s.DomEvent.disableClickPropagation(this._wrapper),s.DomEvent.addListener(this._suggestions,"mouseover",function(n){t.scrollWheelZoom.enabled()&&t.options.scrollWheelZoom&&t.scrollWheelZoom.disable()}),s.DomEvent.addListener(this._suggestions,"mouseout",function(n){!t.scrollWheelZoom.enabled()&&t.options.scrollWheelZoom&&t.scrollWheelZoom.enable()}),this._geosearchCore.on("load",function(n){s.DomUtil.removeClass(this._input,"geocoder-control-loading"),this.clear(),this._input.blur()},this),this._wrapper}});var d=w.FeatureLayerService.extend({options:{label:"Feature Layer",maxResults:5,bufferRadius:1e3,searchMode:"contain",formatSuggestion:function(t){return t.properties[this.options.searchFields[0]]}},initialize:function(t){t.apikey&&(t.token=t.apikey),w.FeatureLayerService.prototype.initialize.call(this,t),"string"==typeof this.options.searchFields&&(this.options.searchFields=[this.options.searchFields]),this._suggestionsQuery=this.query(),this._resultsQuery=this.query()},suggestions:function(t,e,o){var n=this._suggestionsQuery.where(this._buildQuery(t)).returnGeometry(!1);return e&&n.intersects(e),this.options.idField&&n.fields([this.options.idField].concat(this.options.searchFields)),n.run(function(c,l,g){if(c)o(c,[]);else{this.options.idField=g.objectIdFieldName;for(var p=[],y=l.features.length-1;y>=0;y--){var _=l.features[y];p.push({text:this.options.formatSuggestion.call(this,_),unformattedText:_.properties[this.options.searchFields[0]],magicKey:_.id})}o(c,p.slice(0,this.options.maxResults))}},this)},results:function(t,e,o,n){var r=this._resultsQuery;return e?(delete r.params.where,r.featureIds([e])):r.where(this._buildQuery(t)),o&&r.within(o),r.run(s.Util.bind(function(c,l){for(var g=[],p=0;p<l.features.length;p++){var y=l.features[p];if(y){var _=this._featureBounds(y),S={latlng:_.getCenter(),bounds:_,text:this.options.formatSuggestion.call(this,y),properties:y.properties,geojson:y};g.push(S),delete this._resultsQuery.params.objectIds}}n(c,g)},this))},orderBy:function(t,e){this._suggestionsQuery.orderBy(t,e)},_buildQuery:function(t){for(var e=[],o=this.options.searchFields.length-1;o>=0;o--){var n='upper("'+this.options.searchFields[o]+'")';if("contain"===this.options.searchMode)e.push(n+" LIKE upper('%"+t+"%')");else if("startWith"===this.options.searchMode)e.push(n+" LIKE upper('"+t+"%')");else if("endWith"===this.options.searchMode)e.push(n+" LIKE upper('%"+t+"')");else{if("strict"!==this.options.searchMode)throw new Error('L.esri.Geocoding.featureLayerProvider: Invalid parameter for "searchMode". Use one of "contain", "startWith", "endWith", or "strict"');e.push(n+" LIKE upper('"+t+"')")}}return this.options.where?this.options.where+" AND ("+e.join(" OR ")+")":e.join(" OR ")},_featureBounds:function(t){var e=s.geoJson(t);if("Point"===t.geometry.type){var o=e.getBounds().getCenter(),n=this.options.bufferRadius/40075017*360/Math.cos(180/Math.PI*o.lat),r=this.options.bufferRadius/40075017*360;return s.latLngBounds([o.lat-r,o.lng-n],[o.lat+r,o.lng+n])}return e.getBounds()}});var h=w.MapService.extend({options:{layers:[0],label:"Map Service",bufferRadius:1e3,maxResults:5,formatSuggestion:function(t){return t.properties[t.displayFieldName]+" <small>"+t.layerName+"</small>"}},initialize:function(t){t.apikey&&(t.token=t.apikey),w.MapService.prototype.initialize.call(this,t),this._getIdFields()},suggestions:function(t,e,o){return this.find().text(t).fields(this.options.searchFields).returnGeometry(!1).layers(this.options.layers).run(function(r,c,l){var g=[];if(!r){var p=Math.min(this.options.maxResults,c.features.length);l.results=l.results.reverse();for(var y=0;y<p;y++){var _=c.features[y],S=l.results[y],x=S.layerId,Z=this._idFields[x];_.layerId=x,_.layerName=this._layerNames[x],_.displayFieldName=this._displayFields[x],Z&&g.push({text:this.options.formatSuggestion.call(this,_),unformattedText:_.properties[_.displayFieldName],magicKey:S.attributes[Z]+":"+x})}}o(r,g.reverse())},this)},results:function(t,e,o,n){var c,r=[];if(e&&!e.includes(",")){var l=e.split(":")[0],g=e.split(":")[1];c=this.query().layer(g).featureIds(l)}else c=this.find().text(t).fields(this.options.searchFields).layers(this.options.layers);return c.run(function(p,y,_){if(!p){_.results&&(_.results=_.results.reverse());for(var S=0;S<y.features.length;S++){var x=y.features[S];if(g=g||_.results[S].layerId,x&&void 0!==g){var Z=this._featureBounds(x);x.layerId=g,x.layerName=this._layerNames[g],x.displayFieldName=this._displayFields[g];var et={latlng:Z.getCenter(),bounds:Z,text:this.options.formatSuggestion.call(this,x),properties:x.properties,geojson:x};r.push(et)}}}n(p,r.reverse())},this)},_featureBounds:function(t){var e=s.geoJson(t);if("Point"===t.geometry.type){var o=e.getBounds().getCenter(),n=this.options.bufferRadius/40075017*360/Math.cos(180/Math.PI*o.lat),r=this.options.bufferRadius/40075017*360;return s.latLngBounds([o.lat-r,o.lng-n],[o.lat+r,o.lng+n])}return e.getBounds()},_layerMetadataCallback:function(t){return s.Util.bind(function(e,o){if(!e){this._displayFields[t]=o.displayField,this._layerNames[t]=o.name;for(var n=0;n<o.fields.length;n++){var r=o.fields[n];if("esriFieldTypeOID"===r.type){this._idFields[t]=r.name;break}}}},this)},_getIdFields:function(){this._idFields={},this._displayFields={},this._layerNames={};for(var t=0;t<this.options.layers.length;t++){var e=this.options.layers[t];this.get(e,{},this._layerMetadataCallback(e))}}});var m=U.extend({options:{label:"Geocode Server",maxResults:5},suggestions:function(t,e,o){if(this.options.supportsSuggest){var n=this.suggest().text(t);return e&&n.within(e),n.run(function(r,c,l){var g=[];if(!r)for(;l.suggestions.length&&g.length<=this.options.maxResults-1;){var p=l.suggestions.shift();p.isCollection||g.push({text:p.text,unformattedText:p.text,magicKey:p.magicKey})}o(r,g)},this)}return o(null,[]),!1},results:function(t,e,o,n){var r=this.geocode().text(t);return e&&r.key(e),r.maxLocations(this.options.maxResults),o&&r.within(o),r.run(function(c,l){n(c,l.results)},this)}});f.ArcgisOnlineProvider=V,f.FeatureLayerProvider=d,f.Geocode=T,f.GeocodeService=U,f.GeocodeServiceProvider=m,f.Geosearch=X,f.GeosearchCore=J,f.MapServiceProvider=h,f.ReverseGeocode=O,f.Suggest=i,f.VERSION="3.1.3",f.WorldGeocodingServiceUrl=L,f.arcgisOnlineProvider=j,f.featureLayerProvider=function a(t){return new d(t)},f.geocode=q,f.geocodeService=function B(t){return new U(t)},f.geocodeServiceProvider=function b(t){return new m(t)},f.geosearch=function v(t){return new X(t)},f.geosearchCore=$,f.mapServiceProvider=function u(t){return new h(t)},f.reverseGeocode=R,f.suggest=K,Object.defineProperty(f,"__esModule",{value:!0})}(I,P(8407),P(9912))}}]);